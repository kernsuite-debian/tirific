<html>
<head>
<meta name="keywords"           content="eso, FITS format, C library">
<link href="doxygen.css" rel="stylesheet" type="text/css">
<title>QFITS Reference Manual 6.2.0</title>
</head>

<body text="#000000" bgcolor="#ffffff">



<!-- Generated by Doxygen 1.4.1 -->
<h1>FITS table handling</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qfits__table.html#ga0">qfits_is_table</a> (const char *filename, int xtnum)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Identify a file as containing a FITS table in extension.  <a href="#ga0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">qfits_header *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qfits__table.html#ga1">qfits_table_prim_header_default</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate a default primary header to store tables.  <a href="#ga1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">qfits_header *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qfits__table.html#ga2">qfits_table_ext_header_default</a> (const qfits_table *t)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate a default extension header to store tables.  <a href="#ga2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">qfits_table *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qfits__table.html#ga3">qfits_table_new</a> (const char *filename, int table_type, int table_width, int nb_cols, int nb_raws)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Table object constructor.  <a href="#ga3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qfits__table.html#ga4">qfits_col_fill</a> (qfits_col *qc, int atom_nb, int atom_dec_nb, int atom_size, tfits_type atom_type, const char *label, const char *unit, const char *nullval, const char *disp, int zero_present, float zero, int scale_present, float scale, int offset_beg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Fill a column object with some provided informations.  <a href="#ga4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">qfits_table *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qfits__table.html#ga5">qfits_table_open</a> (const char *filename, int xtnum)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read a FITS extension.  <a href="#ga5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qfits__table.html#ga6">qfits_table_close</a> (qfits_table *t)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free a FITS table and associated pointers.  <a href="#ga6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qfits__table.html#ga7">qfits_query_column</a> (const qfits_table *th, int colnum, const int *selection)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extract data from a column in a FITS table.  <a href="#ga7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qfits__table.html#ga8">qfits_query_column_seq</a> (const qfits_table *th, int colnum, int start_ind, int nb_rows)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extract consequtive values from a column in a FITS table.  <a href="#ga8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qfits__table.html#ga9">qfits_query_column_data</a> (const qfits_table *th, int colnum, const int *selection, const void *null_value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extract binary data from a column in a FITS table.  <a href="#ga9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qfits__table.html#ga10">qfits_query_column_seq_data</a> (const qfits_table *th, int colnum, int start_ind, int nb_rows, const void *null_value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extract binary data from a column in a FITS table.  <a href="#ga10"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qfits__table.html#ga11">qfits_query_column_nulls</a> (const qfits_table *th, int colnum, const int *selection, int *nb_vals, int *nb_nulls)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Detect NULL values in a column.  <a href="#ga11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qfits__table.html#ga12">qfits_save_table_hdrdump</a> (const void **array, const qfits_table *table, const qfits_header *fh)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Save a table to a FITS file with a given FITS header.  <a href="#ga12"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qfits__table.html#ga13">qfits_table_append_xtension</a> (FILE *outfile, const qfits_table *t, const void **data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Appends a std extension header + data to a FITS table file.  <a href="#ga13"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qfits__table.html#ga14">qfits_table_append_xtension_hdr</a> (FILE *outfile, const qfits_table *t, const void **data, const qfits_header *hdr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Appends a specified extension header + data to a FITS table file.  <a href="#ga14"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qfits__table.html#ga15">qfits_table_field_to_string</a> (const qfits_table *table, int col_id, int row_id, int use_zero_scale)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">given a col and a row, find out the string to write for display  <a href="#ga15"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="ga4" doxytag="qfits_table.c::qfits_col_fill"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int qfits_col_fill           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">qfits_col *&nbsp;</td>
          <td class="mdname" nowrap> <em>qc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>atom_nb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>atom_dec_nb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>atom_size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>tfits_type&nbsp;</td>
          <td class="mdname" nowrap> <em>atom_type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>unit</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>nullval</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>disp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>zero_present</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>float&nbsp;</td>
          <td class="mdname" nowrap> <em>zero</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>scale_present</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>float&nbsp;</td>
          <td class="mdname" nowrap> <em>scale</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>offset_beg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Fill a column object with some provided informations. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>qc</em>&nbsp;</td><td>Pointer to the column that has to be filled </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>unit</em>&nbsp;</td><td>Unit of the data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>label</em>&nbsp;</td><td>Label of the column </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>disp</em>&nbsp;</td><td>Way to display the data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nullval</em>&nbsp;</td><td>Null value </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>atom_nb</em>&nbsp;</td><td>Number of atoms per field. According to the type, an atom is a double, an int, a char, ... </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>atom_dec_nb</em>&nbsp;</td><td>Number of decimals as specified in TFORM </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>atom_size</em>&nbsp;</td><td>Size in bytes of the field for ASCII tables, and of an atom for BIN tables. ASCII tables only contain 1 atom per field (except for A type where you can of course have more than one char per field) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>atom_type</em>&nbsp;</td><td>Type of data (11 types for BIN, 5 for ASCII) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>zero_present</em>&nbsp;</td><td>Flag to use or not zero </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>zero</em>&nbsp;</td><td>Zero value </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>scale_present</em>&nbsp;</td><td>Flag to use or not scale </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>scale</em>&nbsp;</td><td>Scale value </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>offset_beg</em>&nbsp;</td><td>Gives the position of the column </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>-1 in error case, 0 otherwise </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga0" doxytag="qfits_table.c::qfits_is_table"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int qfits_is_table           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>filename</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>xtnum</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Identify a file as containing a FITS table in extension. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>filename</em>&nbsp;</td><td>Name of the FITS file to examine. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>xtnum</em>&nbsp;</td><td>Extension number to check (starting from 1). </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>int 1 if the extension contains a table, 0 else. Examines the requested extension and identifies the presence of a FITS table. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga7" doxytag="qfits_table.c::qfits_query_column"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">unsigned char* qfits_query_column           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const qfits_table *&nbsp;</td>
          <td class="mdname" nowrap> <em>th</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>colnum</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const int *&nbsp;</td>
          <td class="mdname" nowrap> <em>selection</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Extract data from a column in a FITS table. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>th</em>&nbsp;</td><td>Allocated qfits_table </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>colnum</em>&nbsp;</td><td>Number of the column to extract (from 0 to colnum-1) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>selection</em>&nbsp;</td><td>boolean array to define the selected rows </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>unsigned char array</dd></dl>
If selection is NULL, select the complete column.<p>
Extract a column from a FITS table and return the data as a bytes array. The returned array type and size are determined by the column object in the qfits_table and by the selection parameter.<p>
Returned array size in bytes is: nbselected * col-&gt;natoms * col-&gt;atom_size<p>
Numeric types are correctly understood and byte-swapped if needed, to be converted to the local machine type.<p>
NULL values have to be handled by the caller.<p>
The returned object must be deallocated with qfits_free().     </td>
  </tr>
</table>
<a class="anchor" name="ga9" doxytag="qfits_table.c::qfits_query_column_data"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void* qfits_query_column_data           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const qfits_table *&nbsp;</td>
          <td class="mdname" nowrap> <em>th</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>colnum</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const int *&nbsp;</td>
          <td class="mdname" nowrap> <em>selection</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>null_value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Extract binary data from a column in a FITS table. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>th</em>&nbsp;</td><td>Allocated qfits_table </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>colnum</em>&nbsp;</td><td>Number of the column to extract (from 0 to colnum-1) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>selection</em>&nbsp;</td><td>bollean array to identify selected rows </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>null_value</em>&nbsp;</td><td>Value to return when a NULL value comes </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Pointer to void *</dd></dl>
Extract a column from a FITS table and return the data as a generic void* array. The returned array type and size are determined by the column object in the qfits_table.<p>
Returned array size in bytes is: nb_selected * col-&gt;atom_nb * col-&gt;atom_size<p>
NULL values are recognized and replaced by the specified value. The returned object must be deallocated with qfits_free().     </td>
  </tr>
</table>
<a class="anchor" name="ga11" doxytag="qfits_table.c::qfits_query_column_nulls"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int* qfits_query_column_nulls           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const qfits_table *&nbsp;</td>
          <td class="mdname" nowrap> <em>th</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>colnum</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const int *&nbsp;</td>
          <td class="mdname" nowrap> <em>selection</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>nb_vals</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>nb_nulls</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Detect NULL values in a column. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>th</em>&nbsp;</td><td>Allocated qfits_table </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>colnum</em>&nbsp;</td><td>Number of the column to check (from 0 to colnum-1) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>selection</em>&nbsp;</td><td>Array to identify selected rows </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nb_vals</em>&nbsp;</td><td>Gives the size of the output array </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nb_nulls</em>&nbsp;</td><td>Gives the number of detected null values </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>array with 1 for NULLs and 0 for non-NULLs The returned object must be deallocated with qfits_free(). </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga8" doxytag="qfits_table.c::qfits_query_column_seq"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">unsigned char* qfits_query_column_seq           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const qfits_table *&nbsp;</td>
          <td class="mdname" nowrap> <em>th</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>colnum</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>start_ind</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nb_rows</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Extract consequtive values from a column in a FITS table. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>th</em>&nbsp;</td><td>Allocated qfits_table </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>colnum</em>&nbsp;</td><td>Number of the column to extract (from 0 to colnum-1) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>start_ind</em>&nbsp;</td><td>Index of the first row (0 for the first) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nb_rows</em>&nbsp;</td><td>Number of rows to extract </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>unsigned char array Does the same as <a class="el" href="group__qfits__table.html#ga7">qfits_query_column()</a> but on a consequtive sequence of rows Spares the overhead of the selection object allocation The returned object must be deallocated with qfits_free(). </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga10" doxytag="qfits_table.c::qfits_query_column_seq_data"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void* qfits_query_column_seq_data           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const qfits_table *&nbsp;</td>
          <td class="mdname" nowrap> <em>th</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>colnum</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>start_ind</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nb_rows</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>null_value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Extract binary data from a column in a FITS table. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>th</em>&nbsp;</td><td>Allocated qfits_table </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>colnum</em>&nbsp;</td><td>Number of the column to extract (from 0 to colnum-1) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>start_ind</em>&nbsp;</td><td>Index of the first row (0 for the first) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nb_rows</em>&nbsp;</td><td>Number of rows to extract </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>null_value</em>&nbsp;</td><td>Value to return when a NULL value comes </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Pointer to void * Does the same as <a class="el" href="group__qfits__table.html#ga9">qfits_query_column_data()</a> but on a consequtive sequence of rows. Spares the overhead of the selection object allocation The returned object must be deallocated with qfits_free(). </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga12" doxytag="qfits_table.c::qfits_save_table_hdrdump"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int qfits_save_table_hdrdump           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const void **&nbsp;</td>
          <td class="mdname" nowrap> <em>array</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const qfits_table *&nbsp;</td>
          <td class="mdname" nowrap> <em>table</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const qfits_header *&nbsp;</td>
          <td class="mdname" nowrap> <em>fh</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Save a table to a FITS file with a given FITS header. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>array</em>&nbsp;</td><td>Data array. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>table</em>&nbsp;</td><td>table </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fh</em>&nbsp;</td><td>FITS header to insert in the output file. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>-1 in error case, 0 otherwise </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga13" doxytag="qfits_table.c::qfits_table_append_xtension"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int qfits_table_append_xtension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>outfile</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const qfits_table *&nbsp;</td>
          <td class="mdname" nowrap> <em>t</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void **&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Appends a std extension header + data to a FITS table file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>outfile</em>&nbsp;</td><td>Pointer to (opened) file ready for writing. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>t</em>&nbsp;</td><td>Pointer to qfits_table </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>Table data to write </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>int 0 if Ok, -1 otherwise</dd></dl>
Dumps a FITS table to a file. The whole table described by qfits_table, and the data arrays contained in 'data' are dumped to the file. An extension header is produced with all keywords needed to describe the table, then the data is dumped to the file. The output is then padded to reach a multiple of 2880 bytes in size. Notice that no main header is produced, only the extension part.     </td>
  </tr>
</table>
<a class="anchor" name="ga14" doxytag="qfits_table.c::qfits_table_append_xtension_hdr"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int qfits_table_append_xtension_hdr           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>outfile</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const qfits_table *&nbsp;</td>
          <td class="mdname" nowrap> <em>t</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void **&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const qfits_header *&nbsp;</td>
          <td class="mdname" nowrap> <em>hdr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Appends a specified extension header + data to a FITS table file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>outfile</em>&nbsp;</td><td>Pointer to (opened) file ready for writing. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>t</em>&nbsp;</td><td>Pointer to qfits_table </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>Table data to write </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>hdr</em>&nbsp;</td><td>Specified extension header </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>int 0 if Ok, -1 otherwise</dd></dl>
Dumps a FITS table to a file. The whole table described by qfits_table, and the data arrays contained in 'data' are dumped to the file following the specified fits header. The output is then padded to reach a multiple of 2880 bytes in size. Notice that no main header is produced, only the extension part.     </td>
  </tr>
</table>
<a class="anchor" name="ga6" doxytag="qfits_table.c::qfits_table_close"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void qfits_table_close           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">qfits_table *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>t</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Free a FITS table and associated pointers. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>t</em>&nbsp;</td><td>qfits_table to free </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>void Frees all memory associated to a qfits_table structure. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga2" doxytag="qfits_table.c::qfits_table_ext_header_default"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">qfits_header* qfits_table_ext_header_default           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const qfits_table *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>t</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Generate a default extension header to store tables. 
<p>
<dl compact><dt><b>Returns:</b></dt><dd>the header object </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga15" doxytag="qfits_table.c::qfits_table_field_to_string"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char* qfits_table_field_to_string           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const qfits_table *&nbsp;</td>
          <td class="mdname" nowrap> <em>table</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>col_id</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>row_id</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>use_zero_scale</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
given a col and a row, find out the string to write for display 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>table</em>&nbsp;</td><td>table structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>col_id</em>&nbsp;</td><td>col id (0 -&gt; nbcol-1) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>row_id</em>&nbsp;</td><td>row id (0 -&gt; nrow-1) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>use_zero_scale</em>&nbsp;</td><td>Flag to use or not zero and scale </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the string</dd></dl>
This function is highly inefficient, it should not be used in loops to display a complete table. It is more to get one field from time to time, or for debugging puposes. The returned object must be deallocated with qfits_free().     </td>
  </tr>
</table>
<a class="anchor" name="ga3" doxytag="qfits_table.c::qfits_table_new"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">qfits_table* qfits_table_new           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>filename</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>table_type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>table_width</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nb_cols</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nb_raws</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Table object constructor. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>filename</em>&nbsp;</td><td>Name of the FITS file associated to the table </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>table_type</em>&nbsp;</td><td>Type of the table (QFITS_ASCIITABLE or QFITS_BINTABLE) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>table_width</em>&nbsp;</td><td>Width in bytes of the table </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nb_cols</em>&nbsp;</td><td>Number of columns </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nb_raws</em>&nbsp;</td><td>Number of raws </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The table object The columns are also allocated. The object has to be deallocated with <a class="el" href="group__qfits__table.html#ga6">qfits_table_close()</a> </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga5" doxytag="qfits_table.c::qfits_table_open"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">qfits_table* qfits_table_open           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>filename</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>xtnum</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read a FITS extension. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>filename</em>&nbsp;</td><td>Name of the FITS file to examine. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>xtnum</em>&nbsp;</td><td>Extension number to read (starting from 1). </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Pointer to newly allocated qfits_table structure.</dd></dl>
Read a FITS table from a given file name and extension, and return a newly allocated qfits_table structure.     </td>
  </tr>
</table>
<a class="anchor" name="ga1" doxytag="qfits_table.c::qfits_table_prim_header_default"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">qfits_header* qfits_table_prim_header_default           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Generate a default primary header to store tables. 
<p>
<dl compact><dt><b>Returns:</b></dt><dd>the header object </dd></dl>
    </td>
  </tr>
</table>

</body>
</html>
